<?phpdefine('IN_somCBT', true);$phpEx = 'php';$somCBT_root_path = './../';include($somCBT_root_path . 'common.php');//// Start session management//$userdata = session_pagestart($user_ip, PAGE_QUIZ_SUBMIT);init_userprefs($userdata);//// End session managementif( $userdata['session_logged_in'] ) {	$cid =  $HTTP_POST_VARS['ARG1']; //course_id	$qid =  $HTTP_POST_VARS['ARG2']; //quiz_id		// update quiz finish time	$sql = "UPDATE " . QUIZ_ATTEMPTS_TABLE ." SET timefinish = ".time().", reviewed = ".$HTTP_POST_VARS['ARG3']." WHERE quiz_id = ".$qid ." AND user_id = ".$userdata['session_user_id'];	$r = $db->sql_query($sql);		$sql = "INSERT INTO ". TEST_LOG_TABLE. " (user_id, quiz_id, qtime, access, answer) VALUES 					(".$userdata['session_user_id'].", ".$qid.", ".time().", '3', ' ')" ;	$r = $db->sql_query($sql);	include($somCBT_root_path . 'includes/test_page_header.php');	$template->set_filenames(array(	'body' => 'quiz/submit.tpl'));	if ($HTTP_POST_VARS['ARG3'] == 1) {		$template->assign_block_vars('review', array('SLOT' => '<br><br><br>You are NOT registered for a review<br><br><br><br>', 'NOW' => ''));			$meta =  '<script>parent.window.opener.location.reload(false) ; </script>' ;	}	else if ($HTTP_POST_VARS['ARG3'] == 2) {		//following review message changed by SMQ - used to be "you are scheduled for the review..." - SMQ		$template->assign_block_vars('review', array('SLOT' => '<br><br><br>Saving Questions...Please Wait!<br><br><br><br>', 'NOW' => ''));			$meta =  '<script>parent.window.opener.location.reload(false) ; window.setTimeout(\'window.location="'.append_sid('show_review_time.php?ARG1='.$cid.'&ARG2='.$qid).'"; \',3000);</script>' ;		}	//	$template->assign_block_vars('review', array('SLOT' => '<a href="Please wait ', 'NOW' => ''));		$template->assign_vars(array(				'S_ROOTDIR' => $somCBT_root_path,				'META' => $meta,				'S_NAV' => $nav_path)			);}else {	redirect(append_sid("login.php", true));}//// Generate the page//$template->pparse('overall_header');$template->pparse('body');include($somCBT_root_path . 'includes/page_tail.php');/*	1 -> No need for Review	2 -> Need Review, but not reviewed	3 -> Need review & reviewed*/?>