<?php/* * Creates a framed page * Top frame lists all the files that are associated with the current course * Middle frame shows a browse button to upload a new file to the server * Bottom frame - action to be taken with the selected file * Relies heavily on javascript in the corresponding template file */define('IN_somCBT', true);$phpEx = 'php';$somCBT_root_path = './../';include($somCBT_root_path . 'common.php');$mode = ( isset($HTTP_GET_VARS['action']) ) ? ($HTTP_GET_VARS['action']) : ( ( isset($HTTP_POST_VARS['action']) ) ? ($HTTP_POST_VARS['action']) : '') ;$cid =  ( isset($HTTP_GET_VARS['ARG1']) ) ? ($HTTP_GET_VARS['ARG1']) : ( ( isset($HTTP_POST_VARS['ARG1']) ) ? ($HTTP_POST_VARS['ARG1']) : 0) ;//// Start session management//$userdata = session_pagestart($user_ip, PAGE_QUIZ_INDEX);init_userprefs($userdata);//// End session managementif( ( $userdata['session_logged_in'] ) && ( ($userdata['user_level'] == ADMIN) || ($userdata['user_level'] == TEACHER )) ){	$nav_path = 'File Browser' ;	include($somCBT_root_path . 'includes/page_header.'.$phpEx);	$template->set_filenames(array(	'body' => 'questions/file_browser.tpl')	);	$sql = "SELECT course_id FROM " . COURSE_TABLE ." WHERE course_id = " . $cid ." LIMIT 1" ;	if ($result1 = $db->sql_query($sql) ) {			if($quiz = $db->sql_fetchrow($result1) ) 	{ // only if it is a valid course			$template->assign_block_vars('browser',array( 'FILE_LIST' => append_sid('file_list.php?ARG1='.$cid),															'FILE_UPLOAD' => append_sid('upload.php?ARG1='.$cid),															'FILE_BROWSE_ACTION' => append_sid('file_browse_action.php?ARG1='.$cid),										));								} // eof of course validity	}		$template->assign_vars(array(				'S_ROOTDIR' => $somCBT_root_path,				'S_NAV' => $nav_path)			);	}else {	redirect(append_sid("login.php", true));}//// Generate the page//$template->pparse('overall_header');$template->pparse('body');include($somCBT_root_path . 'includes/page_tail.php');?>